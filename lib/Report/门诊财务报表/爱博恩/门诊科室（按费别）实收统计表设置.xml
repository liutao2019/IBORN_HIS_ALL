<ReportQueryInfo Type="FS.SOC.HISFC.OutpatientFee.Components.Report.Common.Setting.ReportQueryInfo,SOC.HISFC.OutpatientFee.Components"><List><List Type="FS.SOC.HISFC.OutpatientFee.Components.Report.Common.Setting.QueryControl,SOC.HISFC.OutpatientFee.Components"><Index>0</Index><Name>dtBeginTime</Name><Text>开始时间：</Text><IsAddText>true</IsAddText><ControlType Type="FS.SOC.HISFC.OutpatientFee.Components.Report.Common.ControlType.DateTimeType,SOC.HISFC.OutpatientFee.Components"><AddDays>0</AddDays><AddMonths>0</AddMonths><CustomFormat>yyyy-MM-dd</CustomFormat><DefaultDataSource></DefaultDataSource><Format>Custom</Format><IsLike>false</IsLike><LikeStr>%{0}%</LikeStr><Size Type="System.Drawing.Size,System.Drawing, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"><Width>120</Width><Height>20</Height></Size><Location Type="System.Drawing.Point,System.Drawing, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"><X>10</X><Y>2</Y></Location><QueryDataSource>Dictionary</QueryDataSource><DataSourceTypeName></DataSourceTypeName><Enabled>true</Enabled></ControlType></List><List Type="FS.SOC.HISFC.OutpatientFee.Components.Report.Common.Setting.QueryControl,SOC.HISFC.OutpatientFee.Components"><Index>1</Index><Name>dtEndTime</Name><Text>结束时间：</Text><IsAddText>true</IsAddText><ControlType Type="FS.SOC.HISFC.OutpatientFee.Components.Report.Common.ControlType.DateTimeType,SOC.HISFC.OutpatientFee.Components"><AddDays>0</AddDays><AddMonths>0</AddMonths><CustomFormat>yyyy-MM-dd</CustomFormat><DefaultDataSource></DefaultDataSource><Format>Custom</Format><IsLike>false</IsLike><LikeStr>%{0}%</LikeStr><Size Type="System.Drawing.Size,System.Drawing, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"><Width>120</Width><Height>20</Height></Size><Location Type="System.Drawing.Point,System.Drawing, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"><X>220</X><Y>2</Y></Location><QueryDataSource>Dictionary</QueryDataSource><DataSourceTypeName></DataSourceTypeName><Enabled>true</Enabled></ControlType></List><List Type="FS.SOC.HISFC.OutpatientFee.Components.Report.Common.Setting.QueryControl,SOC.HISFC.OutpatientFee.Components"><Index>2</Index><Name>cmbDept</Name><Text>挂号科室：</Text><IsAddText>true</IsAddText><ControlType Type="FS.SOC.HISFC.OutpatientFee.Components.Report.Common.ControlType.ComboBoxType,SOC.HISFC.OutpatientFee.Components"><IsAddAll>true</IsAddAll><AllValue Type="FS.FrameWork.Models.NeuObject,FrameWork"><ID>ALL</ID><Name>全部</Name><Memo></Memo></AllValue><DataSource /><DefaultDataSource /><IsLike>false</IsLike><LikeStr>%{0}%</LikeStr><Size Type="System.Drawing.Size,System.Drawing, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"><Width>120</Width><Height>20</Height></Size><Location Type="System.Drawing.Point,System.Drawing, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"><X>640</X><Y>2</Y></Location><QueryDataSource>DepartmentType</QueryDataSource><DataSourceTypeName>C</DataSourceTypeName><Enabled>true</Enabled></ControlType></List><List Type="FS.SOC.HISFC.OutpatientFee.Components.Report.Common.Setting.QueryControl,SOC.HISFC.OutpatientFee.Components"><Index>3</Index><Name>cmbHospital</Name><Text>院    区：</Text><IsAddText>true</IsAddText><ControlType Type="FS.SOC.HISFC.OutpatientFee.Components.Report.Common.ControlType.ComboBoxType,SOC.HISFC.OutpatientFee.Components"><IsAddAll>true</IsAddAll><AllValue Type="FS.FrameWork.Models.NeuObject,FrameWork"><ID>ALL</ID><Name>全部</Name><Memo></Memo></AllValue><DataSource /><DefaultDataSource /><IsLike>false</IsLike><LikeStr>%{0}%</LikeStr><Size Type="System.Drawing.Size,System.Drawing, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"><Width>120</Width><Height>20</Height></Size><Location Type="System.Drawing.Point,System.Drawing, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"><X>430</X><Y>2</Y></Location><QueryDataSource>Sql</QueryDataSource><DataSourceTypeName>select code,name,' ', spell_code,wb_code,mark from com_dictionary  where type = 'HOSPITALLIST'</DataSourceTypeName><Enabled>true</Enabled></ControlType></List></List><QueryDataSource><QueryDataSource Type="FS.SOC.HISFC.OutpatientFee.Components.Report.Common.Setting.QueryDataSource,SOC.HISFC.OutpatientFee.Components"><Name>dataSource</Name><Sql>--门诊科室（按费别）实收统计表
SELECT T.医院, T.挂号科室,
    SUM(合计) 总计, SUM(西药费) 西药费, SUM(中药费) 中药费, SUM(挂号费) 挂号费, SUM(诊查费) 诊查费, SUM(检查费) 检查费,
    SUM(检验费) 检验费, SUM(治疗费) 治疗费, SUM(手术费) 手术费, SUM(麻醉费) 麻醉费, SUM(护理费) 护理费,
    SUM(材料费) 材料费, SUM(其他费) 其他费
FROM
(
    SELECT
        (select a.hospital_name from com_department a where a.dept_code = (select distinct b.dept_code from fin_opr_register b where b.clinic_code = t.clinic_code)) 医院,
        (select a.dept_name from com_department a where a.dept_code = (select distinct b.dept_code from fin_opr_register b where b.clinic_code = t.clinic_code)) 挂号科室,
        (select nvl(sum(nvl(A.OWN_COST,0)- nvl(A.ECO_COST,0) - nvl(A.DONATE_COST, 0)),0)
            from fin_opb_feedetail a where a.invoice_no = t.invoice_no and a.trans_type = t.trans_type） 合计,
        (select nvl(sum(nvl(A.OWN_COST,0)- nvl(A.ECO_COST,0) - nvl(A.DONATE_COST, 0)),0)
            from fin_opb_feedetail a where a.invoice_no = t.invoice_no and a.trans_type = t.trans_type and invo_code = '01') 西药费,
        (select nvl(sum(nvl(A.OWN_COST,0)- nvl(A.ECO_COST,0) - nvl(A.DONATE_COST, 0)),0)
            from fin_opb_feedetail a where a.invoice_no = t.invoice_no and a.trans_type = t.trans_type and invo_code = '02') 中药费,
        (select nvl(sum(nvl(A.OWN_COST,0)- nvl(A.ECO_COST,0) - nvl(A.DONATE_COST, 0)),0)
            from fin_opb_feedetail a where a.invoice_no = t.invoice_no and a.trans_type = t.trans_type and invo_code = '03') 挂号费,
        (select nvl(sum(nvl(A.OWN_COST,0)- nvl(A.ECO_COST,0) - nvl(A.DONATE_COST, 0)),0)
            from fin_opb_feedetail a where a.invoice_no = t.invoice_no and a.trans_type = t.trans_type and invo_code = '04') 诊查费,
        (select nvl(sum(nvl(A.OWN_COST,0)- nvl(A.ECO_COST,0) - nvl(A.DONATE_COST, 0)),0)
            from fin_opb_feedetail a where a.invoice_no = t.invoice_no and a.trans_type = t.trans_type and invo_code = '05') 检查费,
        (select nvl(sum(nvl(A.OWN_COST,0)- nvl(A.ECO_COST,0) - nvl(A.DONATE_COST, 0)),0)
            from fin_opb_feedetail a where a.invoice_no = t.invoice_no and a.trans_type = t.trans_type and invo_code = '06') 检验费,
        (select nvl(sum(nvl(A.OWN_COST,0)- nvl(A.ECO_COST,0) - nvl(A.DONATE_COST, 0)),0)
            from fin_opb_feedetail a where a.invoice_no = t.invoice_no and a.trans_type = t.trans_type and invo_code = '07') 治疗费,
        (select nvl(sum(nvl(A.OWN_COST,0)- nvl(A.ECO_COST,0) - nvl(A.DONATE_COST, 0)),0)
            from fin_opb_feedetail a where a.invoice_no = t.invoice_no and a.trans_type = t.trans_type and invo_code = '08') 手术费,
        (select nvl(sum(nvl(A.OWN_COST,0)- nvl(A.ECO_COST,0) - nvl(A.DONATE_COST, 0)),0)
            from fin_opb_feedetail a where a.invoice_no = t.invoice_no and a.trans_type = t.trans_type and invo_code = '09') 麻醉费,
        (select nvl(sum(nvl(A.OWN_COST,0)- nvl(A.ECO_COST,0) - nvl(A.DONATE_COST, 0)),0)
            from fin_opb_feedetail a where a.invoice_no = t.invoice_no and a.trans_type = t.trans_type and invo_code = '10') 护理费,
        (select nvl(sum(nvl(A.OWN_COST,0)- nvl(A.ECO_COST,0) - nvl(A.DONATE_COST, 0)),0)
            from fin_opb_feedetail a where a.invoice_no = t.invoice_no and a.trans_type = t.trans_type and invo_code = '11') 材料费,
        (select nvl(sum(nvl(A.OWN_COST,0)- nvl(A.ECO_COST,0) - nvl(A.DONATE_COST, 0)),0)
            from fin_opb_feedetail a where a.invoice_no = t.invoice_no and a.trans_type = t.trans_type and invo_code = '12') 其他费
    from fin_opb_invoiceinfo t
    where t.balance_date BETWEEN TO_DATE('&amp;dtBeginTime', 'yyyy-MM-dd') AND TO_DATE('&amp;dtEndTime', 'yyyy-MM-dd') + 1   --操作时间
    and ((select distinct b.dept_code from fin_opr_register b where b.clinic_code = t.clinic_code) = '&amp;cmbDept' or '&amp;cmbDept' = 'ALL')     --挂号科室
    and t.oper_code in (select empl_code from com_employee where empl_type = 'F')
    and ((select a.hospital_id from com_department a
        where a.dept_code = (select distinct b.dept_code from fin_opr_register b where b.clinic_code = t.clinic_code)) = '&amp;cmbHospital' or '&amp;cmbHospital' = 'ALL')     --院区
) T
GROUP BY T.医院, T.挂号科室
ORDER BY T.医院, T.挂号科室
</Sql><AddMapRow>false</AddMapRow><AddMapColumn>true</AddMapColumn><AddMapData>false</AddMapData><AddMapSourceData>false</AddMapSourceData><IsCross>false</IsCross><SqlType>MainReportUsing</SqlType><CrossRows></CrossRows><CrossColumns></CrossColumns><CrossValues></CrossValues><CrossCombinColumns></CrossCombinColumns><SumColumns></SumColumns><CrossGroupColumns></CrossGroupColumns><IsSumRow>true</IsSumRow><SumRows></SumRows><RowGroup /></QueryDataSource></QueryDataSource><QueryFilePath>Report\门诊财务报表\爱博恩\门诊科室（按费别）实收统计表设置.xml</QueryFilePath><PrintInfo Type="FS.SOC.HISFC.OutpatientFee.Components.Report.Common.Setting.PrintInfo,SOC.HISFC.OutpatientFee.Components"><PaperSize Type="System.Drawing.Printing.PaperSize,System.Drawing, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"><Height>1169</Height><PaperName>A4</PaperName><RawKind>0</RawKind><Width>850</Width></PaperSize><SelectPage>false</SelectPage></PrintInfo></ReportQueryInfo>