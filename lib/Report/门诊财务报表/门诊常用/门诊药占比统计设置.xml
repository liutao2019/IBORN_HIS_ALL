<ReportQueryInfo Type="FS.SOC.HISFC.OutpatientFee.Components.Report.Common.Setting.ReportQueryInfo,SOC.HISFC.OutpatientFee.Components"><List><List Type="FS.SOC.HISFC.OutpatientFee.Components.Report.Common.Setting.QueryControl,SOC.HISFC.OutpatientFee.Components"><Index>0</Index><Name>dtBeginTime</Name><Text>开始时间：</Text><IsAddText>true</IsAddText><ControlType Type="FS.SOC.HISFC.OutpatientFee.Components.Report.Common.ControlType.DateTimeType,SOC.HISFC.OutpatientFee.Components"><AddDays>0</AddDays><AddMonths>0</AddMonths><CustomFormat>yyyy-MM-dd</CustomFormat><DefaultDataSource></DefaultDataSource><Format>Custom</Format><IsLike>false</IsLike><LikeStr>%{0}%</LikeStr><Size Type="System.Drawing.Size,System.Drawing, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"><Width>120</Width><Height>20</Height></Size><Location Type="System.Drawing.Point,System.Drawing, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"><X>220</X><Y>2</Y></Location><QueryDataSource>Dictionary</QueryDataSource><DataSourceTypeName></DataSourceTypeName><Enabled>true</Enabled></ControlType></List><List Type="FS.SOC.HISFC.OutpatientFee.Components.Report.Common.Setting.QueryControl,SOC.HISFC.OutpatientFee.Components"><Index>1</Index><Name>dtEndTime</Name><Text>结束时间：</Text><IsAddText>true</IsAddText><ControlType Type="FS.SOC.HISFC.OutpatientFee.Components.Report.Common.ControlType.DateTimeType,SOC.HISFC.OutpatientFee.Components"><AddDays>1</AddDays><AddMonths>0</AddMonths><CustomFormat>yyyy-MM-dd</CustomFormat><DefaultDataSource></DefaultDataSource><Format>Custom</Format><IsLike>false</IsLike><LikeStr>%{0}%</LikeStr><Size Type="System.Drawing.Size,System.Drawing, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"><Width>120</Width><Height>20</Height></Size><Location Type="System.Drawing.Point,System.Drawing, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"><X>420</X><Y>2</Y></Location><QueryDataSource>Dictionary</QueryDataSource><DataSourceTypeName></DataSourceTypeName><Enabled>true</Enabled></ControlType></List><List Type="FS.SOC.HISFC.OutpatientFee.Components.Report.Common.Setting.QueryControl,SOC.HISFC.OutpatientFee.Components"><Index>2</Index><Name>cmbDoct</Name><Text>医生：</Text><IsAddText>true</IsAddText><ControlType Type="FS.SOC.HISFC.OutpatientFee.Components.Report.Common.ControlType.ComboBoxType,SOC.HISFC.OutpatientFee.Components"><IsAddAll>true</IsAddAll><AllValue Type="FS.FrameWork.Models.NeuObject,FrameWork"><ID>ALL</ID><Name>全部</Name><Memo></Memo></AllValue><DataSource /><DefaultDataSource /><IsLike>false</IsLike><LikeStr>%{0}%</LikeStr><Size Type="System.Drawing.Size,System.Drawing, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"><Width>120</Width><Height>20</Height></Size><Location Type="System.Drawing.Point,System.Drawing, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"><X>10</X><Y>2</Y></Location><QueryDataSource>Sql</QueryDataSource><DataSourceTypeName>select empl_code,empl_name,REMARK,SPELL_CODE,WB_CODE from com_employee where empl_type = 'D' and VALID_STATE = '1'</DataSourceTypeName><Enabled>true</Enabled></ControlType></List></List><QueryDataSource><QueryDataSource Type="FS.SOC.HISFC.OutpatientFee.Components.Report.Common.Setting.QueryDataSource,SOC.HISFC.OutpatientFee.Components"><Name>dtPerDocDrugInfo</Name><Sql>SELECT FR.CARD_NO 患者病历卡号,
       FR.NAME PNAME,
       DECODE(FR.SEX_CODE, 'M', '男', 'F', '女', '保密') SEX,
       e.empl_name,
       SUM(DECODE(DRUG_FLAG,'1',FL.PUB_COST + FL.PAY_COST + FL.OWN_COST,0)) 药品总费用,
       SUM(DECODE(DRUG_FLAG,'0',FL.PUB_COST + FL.PAY_COST + FL.OWN_COST,0)) UNDRUG,
       round(SUM(DECODE(DRUG_FLAG,'1',FL.PUB_COST + FL.PAY_COST + FL.OWN_COST,0)) /
       (DECODE((SUM(DECODE(DRUG_FLAG,'1',FL.PUB_COST + FL.PAY_COST + FL.OWN_COST,0)) +
               SUM(DECODE(DRUG_FLAG,'0',FL.PUB_COST + FL.PAY_COST + FL.OWN_COST,0))),0,1,
               (SUM(DECODE(DRUG_FLAG,'1',FL.PUB_COST + FL.PAY_COST + FL.OWN_COST,0)) +
               SUM(DECODE(DRUG_FLAG,'0',FL.PUB_COST + FL.PAY_COST + FL.OWN_COST,0))))),4) PERCENTAGE,             

       MIN(FL.FEE_DATE) DATETIME
      -- '&amp;dtBeginTime' start_date,
      -- '&amp;dtEndTime' end_date
  FROM FIN_OPB_FEEDETAIL FL,
       com_patientinfo FR,
       com_employee e
 WHERE FL.FEE_DATE BETWEEN to_date('&amp;dtBeginTime','yyyy-mm-dd') AND to_date('&amp;dtEndTime','yyyy-mm-dd')
   AND (FL.DOCT_CODE = '&amp;cmbDoct' OR 'ALL' = '&amp;cmbDoct')
   AND FL.CARD_NO = FR.CARD_NO
   and FL.DOCT_CODE = e.empl_code
  AND  PAY_FLAG = '1'
 GROUP BY FR.CARD_NO,
          FR.NAME,
          DECODE(FR.SEX_CODE, 'M', '男', 'F', '女', '保密'),e.empl_name
 ORDER BY DATETIME,e.empl_name</Sql><AddMapRow>false</AddMapRow><AddMapColumn>false</AddMapColumn><AddMapData>false</AddMapData><AddMapSourceData>false</AddMapSourceData><IsCross>false</IsCross><SqlType>MainReportUsing</SqlType><CrossRows></CrossRows><CrossColumns></CrossColumns><CrossValues></CrossValues><CrossCombinColumns></CrossCombinColumns><SumColumns>患者病历卡号</SumColumns><CrossGroupColumns></CrossGroupColumns><IsSumRow>true</IsSumRow><SumRows></SumRows><RowGroup /></QueryDataSource></QueryDataSource><QueryFilePath>Report\门诊财务报表\门诊常用\门诊药占比统计设置.xml</QueryFilePath><PrintInfo Type="FS.SOC.HISFC.OutpatientFee.Components.Report.Common.Setting.PrintInfo,SOC.HISFC.OutpatientFee.Components"><PaperSize Type="System.Drawing.Printing.PaperSize,System.Drawing, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"><Height>1169</Height><PaperName>A4</PaperName><RawKind>0</RawKind><Width>850</Width></PaperSize><SelectPage>false</SelectPage></PrintInfo></ReportQueryInfo>