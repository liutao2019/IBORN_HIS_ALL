<ReportQueryInfo Type="FS.SOC.HISFC.OutpatientFee.Components.Report.Common.Setting.ReportQueryInfo,SOC.HISFC.OutpatientFee.Components"><List><List Type="FS.SOC.HISFC.OutpatientFee.Components.Report.Common.Setting.QueryControl,SOC.HISFC.OutpatientFee.Components"><Index>0</Index><Name>txtName</Name><Text>姓名</Text><IsAddText>true</IsAddText><ControlType Type="FS.SOC.HISFC.OutpatientFee.Components.Report.Common.ControlType.TextBoxType,SOC.HISFC.OutpatientFee.Components"><IsPadLeft>false</IsPadLeft><Length>10</Length><PadLeftName>0</PadLeftName><DefaultDataSource></DefaultDataSource><IsEnterFilter>true</IsEnterFilter><IsLike>false</IsLike><LikeStr>%{0}%</LikeStr><Size Type="System.Drawing.Size,System.Drawing, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"><Width>120</Width><Height>20</Height></Size><Location Type="System.Drawing.Point,System.Drawing, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"><X>620</X><Y>0</Y></Location><QueryDataSource>Dictionary</QueryDataSource><DataSourceTypeName></DataSourceTypeName><Enabled>true</Enabled></ControlType></List><List Type="FS.SOC.HISFC.OutpatientFee.Components.Report.Common.Setting.QueryControl,SOC.HISFC.OutpatientFee.Components"><Index>1</Index><Name>dtBeginTime</Name><Text>开始时间：</Text><IsAddText>true</IsAddText><ControlType Type="FS.SOC.HISFC.OutpatientFee.Components.Report.Common.ControlType.DateTimeType,SOC.HISFC.OutpatientFee.Components"><AddDays>0</AddDays><AddMonths>0</AddMonths><CustomFormat>yyyy-MM-dd</CustomFormat><DefaultDataSource></DefaultDataSource><Format>Custom</Format><IsLike>false</IsLike><LikeStr>%{0}%</LikeStr><Size Type="System.Drawing.Size,System.Drawing, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"><Width>120</Width><Height>20</Height></Size><Location Type="System.Drawing.Point,System.Drawing, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"><X>0</X><Y>0</Y></Location><QueryDataSource>Dictionary</QueryDataSource><DataSourceTypeName></DataSourceTypeName><Enabled>true</Enabled></ControlType></List><List Type="FS.SOC.HISFC.OutpatientFee.Components.Report.Common.Setting.QueryControl,SOC.HISFC.OutpatientFee.Components"><Index>2</Index><Name>dtEndTime</Name><Text>结束时间：</Text><IsAddText>true</IsAddText><ControlType Type="FS.SOC.HISFC.OutpatientFee.Components.Report.Common.ControlType.DateTimeType,SOC.HISFC.OutpatientFee.Components"><AddDays>0</AddDays><AddMonths>1</AddMonths><CustomFormat>yyyy-MM-dd</CustomFormat><DefaultDataSource></DefaultDataSource><Format>Custom</Format><IsLike>false</IsLike><LikeStr>%{0}%</LikeStr><Size Type="System.Drawing.Size,System.Drawing, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"><Width>120</Width><Height>20</Height></Size><Location Type="System.Drawing.Point,System.Drawing, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"><X>200</X><Y>0</Y></Location><QueryDataSource>Dictionary</QueryDataSource><DataSourceTypeName></DataSourceTypeName><Enabled>true</Enabled></ControlType></List><List Type="FS.SOC.HISFC.OutpatientFee.Components.Report.Common.Setting.QueryControl,SOC.HISFC.OutpatientFee.Components"><Index>3</Index><Name>cmbFloor</Name><Text>楼层</Text><IsAddText>true</IsAddText><ControlType Type="FS.SOC.HISFC.OutpatientFee.Components.Report.Common.ControlType.ComboBoxType,SOC.HISFC.OutpatientFee.Components"><IsAddAll>true</IsAddAll><AllValue Type="FS.FrameWork.Models.NeuObject,FrameWork"><ID>ALL</ID><Name>全部</Name><Memo></Memo></AllValue><DataSource /><DefaultDataSource /><IsLike>false</IsLike><LikeStr>%{0}%</LikeStr><Size Type="System.Drawing.Size,System.Drawing, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"><Width>120</Width><Height>20</Height></Size><Location Type="System.Drawing.Point,System.Drawing, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"><X>450</X><Y>0</Y></Location><QueryDataSource>Sql</QueryDataSource><DataSourceTypeName>select '5','五楼' from dual union select '6','六楼' from dual </DataSourceTypeName><Enabled>true</Enabled></ControlType></List></List><QueryDataSource><QueryDataSource Type="FS.SOC.HISFC.OutpatientFee.Components.Report.Common.Setting.QueryDataSource,SOC.HISFC.OutpatientFee.Components"><Name>dgvBedInfo</Name><Sql> select tt.姓名,tt.卡号,tt.套餐类型,tt.套餐,tt.预订状态,m.roomno 预订房间,tt.订房开始时间,tt.订房结束时间, tt.实际情况
 from  iborn_room m
 left join 
  ( select to_char(g.patientname) 姓名,g.patientid 卡号,d1.name 套餐类型,p.name 套餐,d2.name 预订状态,r.roomno 预订房间,to_char(r.indate,'yyyy-mm-dd') 订房开始时间,to_char(r.outdate,'yyyy-mm-dd') 订房结束时间,
         case  when g.packagetype = '1' and f2.bed_no is not null then to_char(f2.in_date,'YYYY-MM-DD')||' 入住：'||substr(f2.bed_no,5,3) 
               when g.packagetype = '2' and f1.bed_no is not null then to_char(f1.in_date,'YYYY-MM-DD')||' 入住：'||substr(f1.bed_no,5,3) ELSE '' END 实际情况         
  from  agreement g 
  inner join  com_dictionary d1  on d1.code = g.packagetype and d1.type='APackgeType'
  inner join  ag_com_package p   on p.id = g.packagecontext and p.packagetype=g.packagetype
  inner join  iborn_roomorder r  on r.patientid = g.patientid and r.packagecontent = g.packagecontext
  inner join  com_dictionary d2  on d2.code = r.status and d2.type='OrderStatus'
  left  join  fin_ipr_inmaininfo f1 on f1.card_no = g.patientid and f1.in_state = 'I' and f1.patient_type = 'Y' and abs(trunc(f1.in_date - r.indate)) &lt; 300
  left  join  fin_ipr_inmaininfo f2 on f2.card_no = g.patientid and f2.in_state = 'I' and f2.patient_type in('F','P', 'L') and abs(trunc(f2.in_date - r.indate)) &lt; 300  
  where 1 = 1
  and   r.outdate between to_date('&amp;dtBeginTime','YYYY-MM-DD') and to_date('&amp;dtEndTime','YYYY-MM-DD') + 1
  -----and   r.indate &gt;= to_date('&amp;dtBeginTime','YYYY-MM-DD') and r.outdate &lt; to_date('&amp;dtEndTime','YYYY-MM-DD') + 1
  and   (substr(r.roomno,1,1) = '&amp;cmbFloor' or '&amp;cmbFloor' = 'ALL')  
  and   (g.patientname like '%&amp;txtName%' or nvl('&amp;txtName','1')='1') 
  and   AgreementStatus&lt;'4'
       
  union 
  
  select f.name 姓名,f.card_no 卡号,case f.patient_type when 'Y'then '月子套餐' when 'F' then '分娩套餐' when 'P' then '分娩套餐' ELSE '--' END 套餐类型,'' 套餐, '已入住' 预订状态,
         substr(f.bed_no,5,3) 预订房间, '' as 订房开始时间,  '' as 订房结束时间, to_char(f.in_date,'YYYY-MM-DD')||' 入住：'||substr(f.bed_no,5,3) 实际情况 
  from   fin_ipr_inmaininfo f 
  where  1 = 1
  and    f.in_state = 'I' and f.patient_no not like 'B%' and f.nurse_cell_code not in('3002')
  and    (substr(f.bed_no,5,1) = '&amp;cmbFloor' or '&amp;cmbFloor' = 'ALL')
  and    (f.out_date between to_date('&amp;dtBeginTime','YYYY-MM-DD') and to_date('&amp;dtEndTime','YYYY-MM-DD') + 1 or f.out_date &lt; to_date('2000-01-01','yyyy-mm-dd'))
  and    f.card_no not in ( select r.patientid from iborn_roomorder r where r.outdate between to_date('&amp;dtBeginTime','YYYY-MM-DD') and to_date('&amp;dtEndTime','YYYY-MM-DD') + 1)
  ) tt on tt.预订房间 = m.roomno
  where 1 = 1
  and   (substr(m.roomno,1,1) = '&amp;cmbFloor' or '&amp;cmbFloor' = 'ALL')   
  order by 预订房间,订房结束时间</Sql><AddMapRow>false</AddMapRow><AddMapColumn>true</AddMapColumn><AddMapData>true</AddMapData><AddMapSourceData>false</AddMapSourceData><IsCross>false</IsCross><SqlType>MainReportUsing</SqlType><CrossRows></CrossRows><CrossColumns></CrossColumns><CrossValues></CrossValues><CrossCombinColumns></CrossCombinColumns><SumColumns></SumColumns><CrossGroupColumns></CrossGroupColumns><IsSumRow>true</IsSumRow><SumRows></SumRows><RowGroup /></QueryDataSource></QueryDataSource><QueryFilePath>Report\现场咨询报表\爱博恩\客户预入住查询设置.xml</QueryFilePath><PrintInfo Type="FS.SOC.HISFC.OutpatientFee.Components.Report.Common.Setting.PrintInfo,SOC.HISFC.OutpatientFee.Components"><PaperSize Type="System.Drawing.Printing.PaperSize,System.Drawing, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"><Height>1169</Height><PaperName>A4</PaperName><RawKind>0</RawKind><Width>850</Width></PaperSize><SelectPage>false</SelectPage></PrintInfo></ReportQueryInfo>